---
title: "Fittrackee è‡ªæ‰˜ç®¡çš„è¿åŠ¨è¿½è¸ªæœåŠ¡"
description: "FitTrackee ä¸€ä¸ªè‡ªæ‰˜ç®¡çš„è¿åŠ¨è¿½è¸ªåº”ç”¨ï¼Œå®ƒå¯ä»¥è½»æ¾çš„å°†è¿åŠ¨æ•°æ®åŒæ­¥åˆ°æœåŠ¡å™¨ï¼Œå¹¶å¯ä»¥é€šè¿‡ strava è‡ªåŠ¨åŒæ­¥ Apple watch å’Œ Garmin çš„è¿åŠ¨æ•°æ®ğŸ“Šã€‚"
date: "2024-05-03"
---

import Callout from "@/components/Callout.astro";

---

æˆ‘æ˜¯æœ‰è¿åŠ¨ä¹ æƒ¯çš„äººï¼Œè¿™äº›å¹´çš„è¿åŠ¨æ•°æ®ä¸€ç›´æ˜¯é€šè¿‡ Apple Watch åŒæ­¥åˆ° Stravaã€‚è™½ç„¶ Starve å·²ç»èƒ½å¤Ÿè¾ƒå¥½çš„è·Ÿè¸ªè‡ªå·±çš„è¿åŠ¨è¡Œä¸ºï¼Œä½†å…¶æ•°æ®æ¯•ç«Ÿæ˜¯ä¿å­˜åœ¨æœåŠ¡å•†çš„äº‘ç«¯ï¼Œè¿™æ ·è‡ªå·±å¯¹æ•°æ®çš„æ‰€æœ‰æƒå°±å˜å¾—ä¸å¯æ§ï¼Œå¦ä¸€æ–¹é¢ï¼Œå•ä¸€çš„ Strava æœåŠ¡ä¹Ÿæ— æ³•æ»¡è¶³è‡ªå·±å¯¹è¿åŠ¨æ•°æ®åˆ†æçš„éœ€æ±‚ã€‚FitTrackee çš„å‡ºç°è§£å†³äº†æ•°æ®åŒæ­¥å’ŒæŒæœ‰çš„é—®é¢˜ï¼Œå®ƒä¸ä»…èƒ½é€šè¿‡è¯»å– gpx æ–‡ä»¶è®°å½•è¿åŠ¨è€…çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Strava-to-FitTrackee å·¥å…·å®ç°è‡ªåŠ¨åŒæ­¥ Strava çš„æ•°æ®åˆ° FitTrackeeã€‚é€šè¿‡ FitTrackee å’Œ Starve çš„ååŒé…åˆï¼Œè®©è¿åŠ¨æ•°æ®çš„åŒæ­¥ã€å­˜å‚¨ã€å±•ç¤ºå˜å¾—ç®€å•ã€‚

FitTrackee çš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œæ”¯æŒ Docker å’Œ Python ä¸¤ç§å®‰è£…æ–¹å¼ï¼Œè‹¥åªæ˜¯æƒ³ä½“éªŒæˆ–å¿«é€Ÿæ„å»ºä¸€ä¸ªæœåŠ¡ï¼Œæ¨èä»¥ Docker çš„æ–¹å¼è¿è¡Œã€‚

## ç¯å¢ƒ

- OS: Ubuntu 22.04.4 LTS x86_64
- Kernel: 5.15.0-105-generic

## å‰ç½®æ¡ä»¶

æœåŠ¡å™¨å®‰è£…å¥½ Docker å’Œ Docker-Composeï¼ˆå‚è€ƒ Docker å®˜æ–¹å®‰è£…æ–‡æ¡£ï¼‰

## FitTrackee å®‰è£…

```bash
âœ  ~ cd /opt
git clone https://github.com/SamR1/FitTrackee.git
cd FitTrackee
cp .env.docker .env
```

.env é…ç½®

```bash
# Application
export FLASK_DEBUG=1
export FLASK_APP=fittrackee/__main__.py
export FLASK_SKIP_DOTENV=1
export APP_SETTINGS=fittrackee.config.DevelopmentConfig
export APP_SECRET_KEY='489yt2h3'
# export APP_WORKERS=
export APP_LOG=fittrackee.log
export UPLOAD_FOLDER=/usr/src/app/uploads

# PostgreSQL
export DATABASE_URL=postgresql://fittrackee:fittrackee@fittrackee-db:5432/fittrackee
export DATABASE_TEST_URL=postgresql://fittrackee:fittrackee@fittrackee-db:5432/fittrackee_test
# export DATABASE_DISABLE_POOLING=

# Redis (required for API rate limits and email sending)
export REDIS_URL=redis://redis:6379

# API rate limits
export API_RATE_LIMITS="1000 per 5 minutes"

# Emails
export UI_URL=http://0.0.0.0:5000
# For development:
# export UI_URL=http://0.0.0.0:3000
export EMAIL_URL=smtp://mail:1025
export SENDER_EMAIL=admin@dev.com
export WORKERS_PROCESSES=2

# Workouts
# export TILE_SERVER_URL=
# export STATICMAP_SUBDOMAINS=
# export MAP_ATTRIBUTION=
```

## æ„å»ºé•œåƒ

```bash
make docker-build
```

## åˆå§‹åŒ–æ•°æ®åº“

```bash
make docker-init
```

## æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€

```bash
root@ubuntu:~# docker ps -a
CONTAINER ID   IMAGE                      COMMAND                  CREATED        STATUS        PORTS                                            NAMES
75d607b7a3f0   fittrackee_fittrackee      "/bin/sh -c 'flask râ€¦"   26 hours ago   Up 26 hours   0.0.0.0:5000->5000/tcp                           fittrackee
0c36797e6ae7   fittrackee_fittrackee-db   "docker-entrypoint.sâ€¦"   26 hours ago   Up 26 hours   0.0.0.0:5435->5432/tcp                           fittrackee-db
a19f2799eddf   mailhog/mailhog            "MailHog"                26 hours ago   Up 26 hours   0.0.0.0:1025->1025/tcp, 0.0.0.0:8025->8025/tcp   fittrackee-mailhog
be46e4adb723   redis:latest               "docker-entrypoint.sâ€¦"   26 hours ago   Up 26 hours   0.0.0.0:6379->6379/tcp                           fittrackee-redis
```

æ‰“å¼€ `localhost:5000` æ³¨å†Œè´¦å·ã€‚

![image.png](https://ossk.cc/file/46bc5e94fa8e9faa6005b.png)

æ³¨å†Œè´¦å·åœ¨æäº¤æ—¶ï¼Œä¼šç»™é‚®ç®±å‘é€ä¸€å°éªŒè¯é‚®ä»¶ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰é…ç½®é‚®ç®±æœåŠ¡å™¨ï¼Œæ‰€ä»¥æ— æ³•æ”¶åˆ°æ¿€æ´»é‚®ä»¶ã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€ localhost:8025 çš„é‚®ç®±æµ‹è¯•å·¥å…·ï¼Œå¤åˆ¶å¹¶æ‰“å¼€å¦‚ä¸‹çš„é“¾æ¥å³å¯æ¿€æ´»è´¦å·ã€‚ï¼ˆå°† `0.0.0.0`æ›¿æ¢ä¸ºå®é™…çš„ ip åœ°å€ï¼‰

![image.png](https://ossk.cc/file/18e6e1e76f6074ff17228.png)

## æ‰‹åŠ¨æ·»åŠ ç¬¬ä¸€æ¡è¿åŠ¨è®°å½•

å¯ä»¥é€‰æ‹©å•ä¸ª GPX æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€‰æ‹© ZIP æ ¼å¼çš„å‹ç¼©åŒ…ã€‚ï¼ˆå¯¹äº iPhone ç”¨æˆ·å¯ä»¥ç›´æ¥ä»å¥åº·ä¸­å¯¼å‡ºæ•°æ®åä¸Šä¼ ï¼‰

![image.png](https://ossk.cc/file/2c5713c115ed6247627b8.png)

## é€šè¿‡ Strava-to-FitTrackee è‡ªåŠ¨åŒæ­¥ Strava çš„æ•°æ®

é€šè¿‡æœ¬å·¥å…·å¯ä»¥è½»æ˜“å®ç°å°† Strava çš„æ•°æ®åŒæ­¥åˆ° FitTrackee ä¸­ï¼Œè¿™é‡Œç®€å•çš„å±•ç¤ºæ­¤å·¥å…·çš„ä½¿ç”¨ã€‚

## å‰ç½®æ¡ä»¶

1. é…ç½®å¥½ Strava API Application å’Œ FitTrackee
2. FitTrackee å®ä¾‹éœ€è¦ç»‘å®šä¸€ä¸ªåŸŸåï¼Œå¹¶ä¸”æ­£ç¡®é…ç½®äº† HTTPSï¼Œå¦åˆ™æ— æ³•æ­£ç¡®å®ç°æˆæƒã€‚
3. FitTrackee éœ€è¦å‹¾é€‰ `workouts:read, workouts:write, å’Œ profile:read` ä¸‰ä¸ªæƒé™

![image.png](https://ossk.cc/file/513078275905236603c3d.png)

![image.png](https://ossk.cc/file/51226c7337893945bc1f3.png)

## å®‰è£…

```bash
cd /opt
git clone https://github.com/jat255/strava-to-fittrackee.git
cd strava-to-fittrackee
apt install python3-poetry
poetry install
cp .env.example .env
```

.env æ–‡ä»¶çš„é…ç½®

```bash
STRAVA_TOKEN_FILE = .strava.tokens.json
FITTRACKEE_TOKEN_FILE = .fittrackee.tokens.json

# Strava configuration (pull from https://www.strava.com/settings/api)

# å‚è€ƒ strava

STRAVA_CLIENT_ID = 86354
STRAVA_CLIENT_SECRET = 6aa590a88a047ac6d9e05c672954edf596134ae5

# FitTrackee configuration

# configure an app at https://<fittrackee_host>/profile/apps with

# "workouts:read workouts:write" scopes

# å‚è€ƒ fittrackee çš„é…ç½®

FITTRACKEE_HOST = fit-track.writely.xyz
FITTRACKEE_CLIENT_ID = CyndkFSWubcFC4wGHFpdf
FITTRACKEE_CLIENT_SECRET = euLul9vC4tbzGmEkQn7IhoiHeEbB50sgds3r7i8frEL1Cteil
```

## æˆæƒ

```bash
poetry run python -m strava_to_fittrackee.s2f --setup-tokens
```

æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œç»ˆç«¯ä¼šå¼¹å‡ºä¸€ä¸ª URL é“¾æ¥ï¼Œç‚¹å‡»é“¾æ¥æˆ–å¤åˆ¶é“¾æ¥è‡³æµè§ˆå™¨è·³è½¬è‡³ Strava æˆæƒé¡µé¢ï¼Œæ­¤æ—¶å½“ç‚¹å‡» Authorize åï¼Œæµè§ˆå™¨ä¼šè¿”å›ä¹Ÿç»™éæ­£å¸¸ç½‘é¡µï¼Œå°†æ­¤ URL å¤åˆ¶åˆ°ç»ˆç«¯ç„¶åå›è½¦ã€‚

æ­£å¸¸çŠ¶æ€ç»ˆç«¯ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ URLï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤ä¼šè·³è½¬è‡³ FitTrackee çš„æˆæƒé¡µé¢ï¼Œç‚¹å‡»æˆæƒåï¼Œå¤åˆ¶åœ°å€æ ä¸­çš„ URL åœ°å€è‡³ç»ˆç«¯ã€‚æ­¤æ—¶å®Œæˆäº†æˆæƒå·¥ä½œã€‚

## åŸºæœ¬ä½¿ç”¨

```bash
poetry run python -m strava_to_fittrackee.s2f --sync -v 2
```

æœ¬å‘½ä»¤ä¼šåŒæ­¥æ‰€æœ‰çš„ strava æ•°æ®è‡³ FitTrackeeã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒStrava çš„å•æ—¥ api è¯·æ±‚ä¸º 2000 æ¬¡ï¼Œæ„å»ºä¸€ä¸ª gpx éœ€è¦è®¿é—® 4 æ¬¡æ¥å£ã€‚å› æ­¤ï¼Œå½“ä½ çš„è®°å½•è¶…è¿‡ 200 æ—¶ï¼ŒåŒæ­¥çš„è¿‡ç¨‹å°†ä¼šéœ€è¦æ•°å¤©çš„æ—¶é—´ã€‚

ä¸‹å›¾å±•ç¤ºçš„æ˜¯æˆ‘çš„ä¸ªäººåŒæ­¥å®Œæˆçš„æ•°æ®ã€‚

![image.png](https://ossk.cc/file/95445035832a6052e8f37.png)

![image.png](https://ossk.cc/file/2bbd02f88863ac9b0d2a1.png)

å…³äº Strava-to-FitTrackee å·¥å…·æ›´å¤šçš„ä½¿ç”¨æ¡ˆä¾‹å¯ä»¥å‚è€ƒå®ƒçš„å®˜æ–¹ä»“åº“ï¼Œè¿™é‡Œä¸å†æ¼”ç¤ºã€‚

## æ­¤ç¯‡æ–‡ç« æåŠçš„ä»“åº“åœ°å€

- https://github.com/jat255/strava-to-fittrackee
- https://github.com/SamR1/FitTrackee
